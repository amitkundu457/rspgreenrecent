import{r as o,j as e,b as p}from"./app-D84j7SCT.js";import{g as F}from"./index-D4x-ylCN.js";import{u as k}from"./index-ByJS6pL2.js";import{H as T,N as A}from"./Header-C3uwYM-0.js";import"./iconBase-Cc3CELI8.js";import"./index-d2EYOdEl.js";import"./index-TAr1_Bl1.js";const Y=({user:x,user_type:f,notif:j,quotes:y})=>{const[d,c]=o.useState([]),[l,m]=o.useState(null),[i,g]=o.useState(!1),[h,b]=o.useState(!1),[R,u]=o.useState(""),{data:a,setData:t,post:N,put:v,errors:L,reset:w}=k({source:"Direct",name:"",email:"",contact:"",subject:"",message:"",document:null,lastdate:""});o.useEffect(()=>{(async()=>{try{const s=await p.get("/enquiry");c(s.data)}catch{u("Error fetching inquiries.")}})()},[]);const C=async r=>{r.preventDefault(),b(!0),u("");try{const s=new FormData;if(Object.keys(a).forEach(n=>{s.append(n,a[n])}),l!==null){const n=await v(`/enquiry/${d[l].id}`,s,{headers:{"Content-Type":"multipart/form-data"}}),I=d.map((S,D)=>D===l?n.data:S);c(I)}else{const n=await N("/enquiry",s,{headers:{"Content-Type":"multipart/form-data"}});c([...d,n.data])}w(),g(!1),m(null)}catch{u("Error submitting form. Please try again.")}finally{b(!1)}},q=r=>{t("document",r.target.files[0])},E=async r=>{if(window.confirm("Are you sure you want to delete this inquiry?"))try{await p.delete(`/enquiry/${r}`),c(d.filter(s=>s.id!==r))}catch(s){console.error("Error deleting inquiry",s)}};return e.jsxs("div",{className:"w-[85.2%] ml-[11.5rem] absolute right-0",children:[e.jsx(T,{user:x,notif:j}),e.jsx(A,{user_type:f}),e.jsxs("div",{className:"container mx-auto p-4",children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsxs("button",{className:"bg-green-500 text-white px-4 py-2 rounded-full flex items-center shadow hover:bg-green-600",onClick:()=>g(!i),children:[e.jsx(F,{className:"mr-2"}),i?"Close Form":"Request An Inquiry"]})}),i&&e.jsxs("div",{className:"bg-white shadow-md rounded-lg p-6 mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-center text-green-600",children:l!==null?"Edit Inquiry":"Request An Inquiry"}),e.jsxs("form",{onSubmit:C,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("select",{name:"source",className:"border border-gray-300 rounded p-2 focus:outline-none focus:ring-2 focus:ring-green-500",value:a.source,onChange:r=>t("source",r.target.value),children:[e.jsx("option",{value:"",children:"Select Source"}),e.jsx("option",{value:"Direct",children:"Direct"}),e.jsx("option",{value:"Quotation",children:"Quotation"}),e.jsx("option",{value:"Tender",children:"Tender"})]}),a.source==="Tender"&&e.jsx("input",{type:"date",name:"lastdate",className:"border border-gray-300 rounded p-2 focus:outline-none focus:ring-2 focus:ring-green-500",value:a.lastdate,onChange:r=>t("lastdate",r.target.value)}),e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"text",name:"name",placeholder:"Name *",className:"border border-gray-300 rounded p-2 focus:outline-none focus:ring-2 focus:ring-green-500",value:a.name,onChange:r=>t("name",r.target.value)}),e.jsx("input",{type:"email",name:"email",placeholder:"Email id *",className:"border border-gray-300 rounded p-2 focus:outline-none focus:ring-2 focus:ring-green-500",value:a.email,onChange:r=>t("email",r.target.value)}),e.jsx("input",{type:"text",name:"contact",placeholder:"Contact No *",className:"border border-gray-300 rounded p-2 focus:outline-none focus:ring-2 focus:ring-green-500",value:a.contact,onChange:r=>t("contact",r.target.value)})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Upload Document"}),e.jsx("input",{type:"file",onChange:q,className:"mt-1 block w-full"})]}),e.jsx("textarea",{name:"message",placeholder:"Your message here..",className:"border border-gray-300 rounded p-2 w-full mt-4 focus:outline-none focus:ring-2 focus:ring-green-500",rows:"4",value:a.message,onChange:r=>t("message",r.target.value)}),e.jsx("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-2 rounded w-full mt-4 hover:bg-blue-600",disabled:h,children:h?"Submitting...":l!==null?"Update Inquiry":"Submit"})]})]}),e.jsxs("div",{className:"bg-white shadow-md rounded-lg p-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Inquiries List"}),e.jsxs("table",{className:"table-auto w-full border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100",children:[e.jsx("th",{className:"border border-gray-300 p-2",children:"Source"}),e.jsx("th",{className:"border border-gray-300 p-2",children:"Name"}),e.jsx("th",{className:"border border-gray-300 p-2",children:"Email"}),e.jsx("th",{className:"border border-gray-300 p-2",children:"Contact"}),e.jsx("th",{className:"border border-gray-300 p-2",children:"Last Date"}),e.jsx("th",{className:"border border-gray-300 p-2",children:"Message"}),e.jsx("th",{className:"border border-gray-300 p-2",children:"Actions"})]})}),e.jsx("tbody",{children:y.map((r,s)=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-300 p-2",children:r.source}),e.jsx("td",{className:"border border-gray-300 p-2",children:r.name||"-"}),e.jsx("td",{className:"border border-gray-300 p-2",children:r.email||"-"}),e.jsx("td",{className:"border border-gray-300 p-2",children:r.contact||"-"}),e.jsx("td",{className:"border border-gray-300 p-2",children:r.lastdate||"-"}),e.jsx("td",{className:"border border-gray-300 p-2",children:r.message||"-"}),e.jsxs("td",{className:"border border-gray-300 p-2",children:[e.jsx("button",{className:"bg-yellow-500 text-white px-2 py-1 rounded mr-2 hover:bg-yellow-600",onClick:()=>m(s),children:"Edit"}),e.jsx("button",{className:"bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600",onClick:()=>E(r.id),children:"Delete"})]})]},s))})]})]})]})]})};export{Y as default};
