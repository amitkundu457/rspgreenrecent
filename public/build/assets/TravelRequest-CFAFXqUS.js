import{q as R,r as l,W as S,j as e,a as E,b as D}from"./app-DcosoOGz.js";import{H as A,N as k}from"./Header-CpISEJT8.js";import"./index-BdICc8gQ.js";import"./iconBase-BoGeFUZy.js";import"./index-CWrYJs3k.js";function H({user:i,user_type:b,notif:j}){const{travelAllowances:c,us:m}=R().props,[o,g]=l.useState(null);l.useState(!1),l.useState(null);const[u,f]=l.useState(""),[v,p]=l.useState(!1),[n,N]=l.useState(null),{data:t,setData:r,post:w,put:_,delete:q,processing:x,reset:h}=S({employee_id:(i==null?void 0:i.id)||"",employee_name:"",amount:"",travel_date:"",reason:"",destination:"",payment_by:"",payment_mode:"Cash",extra_payment:"",document:null,status:"Pending",Destination_amount:""});l.useEffect(()=>{if(o){const a=c.find(s=>s.id===o);a&&r({...t,id:a.id,employee_name:a.employee_name,amount:a.amount,travel_date:a.travel_date,reason:a.reason,destination:a.destination,payment_by:a.payment_by,extra_payment:a.extra_payment,status:a.status,document:null})}},[o]);const C=a=>{a.preventDefault();const s=new FormData;s.append("employee_id",t.employee_id),s.append("employee_name",t.employee_name),s.append("amount",t.amount),s.append("travel_date",t.travel_date),s.append("reason",t.reason),s.append("destination",t.destination),s.append("payment_by",t.payment_by),s.append("payment_mode",t.payment_mode),s.append("extra_payment",t.extra_payment),s.append("status",t.status),t.document&&s.append("document",t.document),o?_(route("travel-allowances.update",t.id),{data:s,onSuccess:()=>{h(),g(null)}}):w(route("travel-allowances.store"),{data:s,onSuccess:()=>{h()}})},y=async(a,s)=>{try{const d=await D.put(`/travel-allowances/${a}/status`,{status:s});console.log("Status updated successfully:",d.data)}catch(d){console.error("Error updating status:",d.response?d.response.data:d.message)}};return e.jsxs("div",{className:"w-[85%] absolute right-0 overflow-hidden bg-gray-100 min-h-screen",children:[e.jsx(A,{user:i,notif:j}),e.jsx(k,{user_type:b}),e.jsxs("div",{className:"p-8 bg-white rounded-b-md",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Extra Travel Allowances"}),m!==1&&e.jsxs("form",{onSubmit:C,className:"space-y-4",encType:"multipart/form-data",children:[e.jsx("input",{type:"text",placeholder:"Employee Name",value:t.employee_name,onChange:a=>r("employee_name",a.target.value),required:!0,className:"w-full p-2 border rounded-md"}),e.jsx("input",{type:"date",value:t.travel_date,onChange:a=>r("travel_date",a.target.value),required:!0,className:"w-full p-2 border rounded-md"}),e.jsx("textarea",{placeholder:"Reason",value:t.reason,onChange:a=>r("reason",a.target.value),className:"w-full p-2 border rounded-md"}),e.jsx("input",{type:"text",placeholder:"Destination",value:t.destination,onChange:a=>r("destination",a.target.value),required:!0,className:"w-full p-2 border rounded-md"}),e.jsx("input",{type:"number",placeholder:"Enter Your Amount",value:t.amount,onChange:a=>r("amount",a.target.value),required:!0,className:"w-full p-2 border rounded-md"}),e.jsx("input",{type:"file",onChange:a=>r("document",a.target.files[0]),className:"w-full p-2 border rounded-md"}),e.jsx("button",{type:"submit",className:`w-full p-2 text-white rounded-md ${x?"bg-gray-400":"bg-blue-500 hover:bg-blue-600"}`,disabled:x,children:o?"Update":"Create"})]})]}),m===1&&e.jsxs("div",{className:"p-8 bg-white rounded-md mt-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Travel Allowance List"}),c&&c.length>0?e.jsxs("table",{className:"w-full border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100",children:[e.jsx("th",{className:"border px-4 py-2",children:"Employee Id"}),e.jsx("th",{className:"border px-4 py-2",children:"Date"}),e.jsx("th",{className:"border px-4 py-2",children:"Reason"}),e.jsx("th",{className:"border px-4 py-2",children:"Payment Mode"}),e.jsx("th",{className:"border px-4 py-2",children:"Status"}),e.jsx("th",{className:"border px-4 py-2",children:"Actions"})]})}),e.jsx("tbody",{children:c.map(a=>e.jsxs("tr",{className:"border",children:[e.jsxs("td",{className:"border px-4 py-2",children:["EMP0000",a.id]}),e.jsx("td",{className:"border px-4 py-2",children:a.travel_date}),e.jsx("td",{className:"border px-4 py-2",children:a.reason}),e.jsx("td",{className:"border px-4 py-2",children:"Cash"}),e.jsx("td",{className:"border px-4 py-2",children:e.jsx("span",{className:`px-2 py-1 rounded ${a.status==="Approved"?"bg-green-500 text-white":a.status==="Rejected"?"bg-red-500 text-white":"bg-gray-300"}`,children:a.status||"Pending"})}),e.jsxs("td",{className:"border px-4 py-2 flex space-x-2",children:[e.jsx("button",{className:"px-3 py-1 bg-green-500 text-white rounded",onClick:()=>y(a.id,"Approved"),children:"Approve"}),e.jsx("button",{className:"px-3 py-1 bg-red-500 text-white rounded",onClick:()=>{N(a),p(!0)},children:"Reject"}),e.jsx(E,{href:`/view-all-document/${a.id}`,className:"px-3 py-1 text-sm bg-blue-600 text-white rounded-md shadow-md hover:bg-blue-700 transition-all duration-200",title:"View Details",onClick:()=>console.log(`Navigating to details of ID: ${a.id}`),children:"View Details"})]})]},a.id))})]}):e.jsx("p",{children:"No travel allowances found."}),v&&e.jsx("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-50 flex justify-center items-center",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-96",children:[e.jsxs("h3",{className:"text-xl font-semibold mb-4",children:["Reject Travel Allowance for"," ",n==null?void 0:n.employee_name]}),e.jsxs("p",{children:["Are you sure you want to reject the travel allowance for ",n==null?void 0:n.employee_name,"?"]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{htmlFor:"rejectionReason",className:"block text-sm font-medium mb-2",children:"Rejection Reason"}),e.jsx("textarea",{id:"rejectionReason",placeholder:"Enter reason for rejection",value:u,onChange:a=>f(a.target.value),className:"w-full p-2 border rounded-md",rows:"3"})]}),e.jsxs("div",{className:"mt-4 flex justify-end space-x-4",children:[e.jsx("button",{className:"px-4 py-2 bg-gray-500 text-white rounded",onClick:()=>p(!1),children:"Cancel"}),e.jsx("button",{className:"px-4 py-2 bg-red-500 text-white rounded",onClick:()=>{if(u.trim()===""){alert("Please provide a rejection reason.");return}y(n.id,"Rejected"),p(!1)},children:"Reject"})]})]})})]})]})}export{H as default};
